cases:
  - name: const doesn't allow reassignment

    status: 1
    stdout: >
      thread 'main' panicked at 'Error calling:
      "node-gyp ["build"]"
                                                     8
      Got:
        CXX(target) Release/obj.target/const/const.o
                                                     9
      gyp info it worked if it ends with ok
      gyp info using node-gyp@3.8.0
      gyp info using node@11.1.0 | darwin | x64       0
      gyp info spawn make
      gyp info spawn args [ 'BUILDTYPE=Release', '-C', 'build' ]
      ../const.cc:27:7: error: no viable overloaded '='
        a_1 = Number::New(isolate, 2);
        ~~~ ^ ~~~~~~~~~~~~~~~~~~~~~~~
      /Users/philipeaton/.node-gyp/11.1.0/include/node/v8.h:303:7: note: candidate function (the implicit copy assignment operator) not viable: 'this' argument has t
      ype 'const Local<v8::Value>', but method is not marked const
      class Local {
            ^
      /Users/philipeaton/.node-gyp/11.1.0/include/node/v8.h:303:7: note: candidate function (the implicit move assignment operator) not viable: 'this' argument has t
      ype 'const Local<v8::Value>', but method is not marked const
      ../const.cc:38:3: warning: expression result unused [-Wunused-value]
        result_8;
        ^~~~~~~~
      1 warning and 1 error generated.
      make: *** [Release/obj.target/const/const.o] Error 1
      gyp ERR! build error
      gyp ERR! stack Error: `make` failed with exit code: 2
      gyp ERR! stack     at ChildProcess.onExit (/usr/local/lib/node_modules/node-gyp/lib/build.js:262:23)
      gyp ERR! stack     at ChildProcess.emit (events.js:182:13)
      gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:246:12)
      gyp ERR! System Darwin 18.2.0
      gyp ERR! command "/usr/local/Cellar/node/11.1.0/bin/node" "/usr/local/bin/node-gyp" "build"
      gyp ERR! cwd /Users/philipeaton/projects/jsc/build
      gyp ERR! node -v v11.1.0
      gyp ERR! node-gyp -v v3.8.0
      gyp ERR! not ok
      
      ', src/jsc/build.rs:12:17
      note: Run with `RUST_BACKTRACE=1` for a backtrace.

templates:
- test.js: |
    function main () {
      const a = 1;
      a = 2;
    }
